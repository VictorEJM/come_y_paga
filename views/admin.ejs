<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Panel de administración</title>
	<link rel="stylesheet" href="/styles/style.css">
	<style>
		body {
			font-size: 32px;
		}
		th {
			background-color: rgb(245, 253, 129);
		}
		tr:nth-child(even) {
			background-color: #93d8ff;
		}
		tr:nth-child(odd) {
			background-color: #b6d8ff;
		}

		#botonesTablas button {
			display: inline-block;
			margin-right: 10px;
		}

	</style>
</head>
<body>
	<h1>Panel de administración</h1>
	
	<script>
		// MOSTRAR TABLAS
		function mostrarTablaUsuarios() {
			document.getElementById("usuarios-tabla").style.display = "block";
				document.getElementById("restaurantes-tabla").style.display = 
				document.getElementById("platos-tabla").style.display = 
				document.getElementById("pedidos-tabla").style.display = 
				"none";
		}
		function mostrarTablaRestaurantes() {
			document.getElementById("restaurantes-tabla").style.display = "block";
				document.getElementById("usuarios-tabla").style.display = 
				document.getElementById("platos-tabla").style.display = 
				document.getElementById("pedidos-tabla").style.display = 
				"none";
		}
		function mostrarTablaPlatos() {
			document.getElementById("platos-tabla").style.display = "block";
				document.getElementById("usuarios-tabla").style.display = 
				document.getElementById("restaurantes-tabla").style.display = 
				document.getElementById("pedidos-tabla").style.display = 
				"none";
		}
		function mostrarTablaPedidos() {
			document.getElementById("pedidos-tabla").style.display = "block";
				document.getElementById("usuarios-tabla").style.display = 
				document.getElementById("restaurantes-tabla").style.display = 
				document.getElementById("platos-tabla").style.display = 
				"none";
		}

		function mostrarUsuarioDetalles(id, nombre, apellidos, direccion, telefono, municipio) {
			var divDetalles = document.getElementById(`user-details-${id}`);
			divDetalles.style.display = 
			 (divDetalles.style.display === "none")
				? "block"
				: divDetalles.style.display = "none";
			divDetalles.innerHTML = "<p>Nombre: " + nombre + "</p>" +
									"<p>Apellidos: " + apellidos + "</p>" +
									"<p>Dirección: " + direccion + "</p>" +
									"<p>Teléfono: " + telefono + "</p>" +
									"<p>Municipio: " + municipio + "</p>";
		}
		function mostrarFormularioUsuarios() {
			document.getElementById("form-add-user").style.display = "block";
		}
	</script>
	<center>
		<form method="POST" action="/logout">
		  <button class="btn_button_bottom" type="submit" style="
			display: inline-block;
			padding: 2.35%;
			font-size: 46px;
			text-align: center;
			text-decoration: none;">
			<img src="images/logout.png" alt="logout" width="10%" />
			Cerrar sesión
		  </button>
		</form>

		<div id="botonesTablas">
			<p>PULSE ALGUNO DE ESOS BOTONES PARA VISUALIZAR TAL TABLA DE LA BASE DE DATOS:
			</p>
			<button style="background-color: #00ffd565;" onclick="mostrarTablaUsuarios()">
				USUARIOS
			</button>
			
			<button style="background-color: #00ff4c65;" onclick="mostrarTablaRestaurantes()">
				RESTAURANTES
			</button>
			
			<button style="background-color: #00ccff65;" onclick="mostrarTablaPlatos()">
				PLATOS
			</button>
			
			<button style="background-color: #1900ff65;" onclick="mostrarTablaPedidos()">
				PEDIDOS
			</button>
		</div>

		<!-- ERROR -->
		<h2 style="color: #ff0000;"><%= error %=></h2>
	
	
	<!-- Tabla de usuarios -->
	<div id="usuarios-tabla">
		<p>GESTIÓN DE LA TABLA USUARIOS</p>
		<button style="background-color: #2bff0065;" onclick="mostrarFormularioUsuarios()">
			<img src="images/admin/insert.png" alt="insertar" style=" width: 7%;" />AÑADIR
		</button>

		<!-- Formulario para agregar usuarios -->
		<form id="form-add-user" method="POST" action="/admin/add" style="display:none;">
			<label for="nombre">nombre:</label>
				<input type="text" name="nombre" required>
			<label for="fecha_nacimiento">fecha_nacimiento:</label>
				<input type="date" id="fecha_nacimiento" name="fecha_nacimiento" required
				min="1900-01-01" max="2600-01-01" value="2000-01-01">
			<label for="direccion">direccion:</label>
				<input type="text" name="direccion" required>
			<label for="telefono">telefono:</label>
				<input type="text" name="telefono" required>
			<label for="email">email:</label>
				<input type="email" name="email" required>
			<label for="municipio">municipio:</label>
				<input type="text" name="municipio" required>
			<label for="nombre_usuario">nombre_usuario:</label>
				<input type="text" name="nombre_usuario" required>
			<label for="contrasena_usuario">contrasena_usuario:</label>
				<input type="text" name="contrasena_usuario" required>
			<label for="tipo_usuario">tipo_usuario:</label>
				<input type="radio" name="tipo_usuario" value="administrador" required> Administrador
				<input type="radio" name="tipo_usuario" value="repartidor" required> Repartidor
				<input type="radio" name="tipo_usuario" value="cliente" required> Cliente
			<button type="submit" style="font-size: 30px">Agregar usuario</button>
		</form>
		<table>
			<thead>
				<tr>
					<th>id</th>
					<th>nombre_usuario</th>
					<th>email</th>
					<th>Acciones</th>
				</tr>
			</thead>
			<tbody>
				<% users.forEach(function(user) { %>
					<tr>
						<td><%= user.id %></td>
						<td><%= user.nombre_usuario %></td>
						<td><%= user.email %></td>
						<!--
							<td><%= user.fecha_nacimiento %></td>
							<td><%= user.direccion %></td>
							<td><%= user.telefono %></td>
							<td><%= user.email %></td>
							<td><%= user.contrasena_usuario %></td>
							<td><%= user.tipo_usuario %></td>
							<td><%= user.municipio %></td>
						-->
						<td>
							<button onclick="mostrarUsuarioDetalles('<%= user.id %>', 
								'<%= user.nombre %>', '<%= user.apellidos %>', 
								'<%= user.direccion %>', '<%= user.telefono %>', 
								'<%= user.municipio %>')"
								style="background-color:#ff000000;">
								<img src="images/admin/consult.png" alt="consultarDetalles" style="width: 50px;" />
							</button>
							<!-- Botones de acción -->
							<form method="POST" action="/admin/edit-user">
								<input type="hidden" name="id" value="<%= user.id %>">
								<button type="submit" style="background-color:#ff000000;">
									<img src="images/admin/update.png" alt="editar" style="width: 50px;" />
								</button>
							</form>
							<form method="POST" action="/admin/delete-user">
								<input type="hidden" name="id" value="<%= user.id %>">
								<button type="submit" style="background-color:#ff000000;">
									<img src="images/admin/delete.png" alt="eliminar" style="width: 50px;" />
								</button>
							</form>
						</td>
					</tr>
					<td>
						<div id="user-details-<%= user.id %>"
							style="display: none;
							padding: 10px;
							margin: 10px;
							background-color: #ff9e4e;
							border: 1px solid #ff5f15;">
						</div>
					</td>
				<% }); %>
			</tbody>
		</table>
	</div>

	<div id="restaurantes-tabla">
		<p>GESTIÓN DE LA TABLA RESTAURANTES</p>

	</div>

	<div id="platos-tabla">
		<p>GESTIÓN DE LA TABLA PLATOS</p>

	</div>

	<div id="pedidos-tabla">
		<p>GESTIÓN DE LA TABLA PEDIDOS</p>

	</div>
</center>
</body>
</html>
